{
    "contents" : "\n#' @title Bootstrap Estimation of Correlation\n#' @export\n#' @return Returns a list containing: the estimated correlation of the two given vectors, the bootstrap estimated correlation of the data and the 95 percent confidence interval.\n#' @usage bootstrap.correlation(n=2000, x , y, plot = FALSE)\n#' @keywords Estimating the correlation, bootstrap estimate, and confidence interval\n#' @description This function takes as arguments the number of bootstrap replicates \\code{n},\n#' \\code{x} and \\code{y} which are two numerical vectors / data, then bootstrap from \\code{x ,y}, and calculate the correlation of these data for each resampling n times.\n#' If \\code{plot} is chosen to be TRUE, then the function plots the histogram, as well as the 95% confidence interval for the\n#' estimates.\n#' @import graphics\n#' @import stats\n#' @param x a numeric vector.\n#' @param y a numeric vector.\n#' @param n number of bootstrap samples.\n#' @param plot specifies whether a plot should be created or not\n#' @author Nguyen Khanh Le Ho \\cr\n#' @examples\n#' bootstrap.correlation(n=2000,cars$speed,cars$dist, plot=TRUE )\n\n\nbootstrap.correlation <- function(n = 2000, x , y, plot = FALSE){\n\n  #------------------------------------Error Handler:--------------------------------------#\n  # ---------------------------------------------------------------------------------------#\n  # 'n' must be numeric, natural number greater than 1.                                    #\n  # 'x, y' must be numerical vectors.                                                      #\n  # 'plot' must booblean valued.                                                           #\n  #----------------------------------------------------------------------------------------#\n\n  if(!is.numeric(n) || n!= round(n) || n < 1 ){\n    stop(\"The number of bootstrap sample 'n' must be a natural number greater than 1.\")\n  }\n  if(is.list(y) || is.list(x) || !is.numeric(x) || !is.numeric(y) || is.matrix(x+y) || !is.vector(x+y)   ){\n    stop(\" The given data 'x' or 'y' must be a numercial vector.\")\n  }\n  if(length(x)!= length(y) ){\n    stop(\"Length of the given data x and y must be equal\")\n  }\n  if(!is.logical(plot)){\n    stop(\"'plot' must be logical.\")\n  }\n\n  #---------------------------------------End Error Handler---------------------------------#\n\n  storage <- c(1:n)\n  size <- length(x)\n\n  #Calculation the populations correlation:\n  #---------------------------------------\n  estCor <- cor(x,y)\n\n  #Bootstrap estimation of correlation and confidence interval:\n  #-----------------------------------------------------------\n\n\n  for(i in 1:n){\n    k<-  sample(c(1:size),size,replace = TRUE) # sampling from the population\n    storage[i]<-  cor(x[k], y[k])\n  }\n\n  bootCor <- mean(storage)           # Calculating the bootstrap est. of correlation\n  bias <- mean(storage - estCor)     # Bias\n  SE = sd(storage)                   # Stanard Error\n  CI = c(bootCor - 1.96*SE, bootCor+1.96*SE)  # 95% Confidence interval\n\n  if(plot== TRUE){\n    hist(storage, main = \"Blue line: Estimated, Red lines: ConfInt\", xlab = \"correlation\")\n    abline(v = c(CI[1], CI[2], estCor), col=c(\"red\",\"red\", \"blue\"))\n  }\n\n\n  f <- list( \"Estimated\" = estCor, \"BootstrapEst\" = bootCor ,\"Bias\" = bias, \"ConfInt\" = CI)\n\n  return(f)\n\n}\n",
    "created" : 1464257340858.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3013100685",
    "id" : "A55128F1",
    "lastKnownWriteTime" : 1464802327,
    "path" : "C:/Users/hongu/Desktop/University/Statistics/R Code/anything/R/bootstrap.correlation.R",
    "project_path" : "R/bootstrap.correlation.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "type" : "r_source"
}